<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script>
      (function () {
        function escapeHtml(input) {
          return String(input || "")
            .replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;")
            .replace(/'/g, "&#39;");
        }

        let title = "Gallery-Portfolio";
        try {
          const raw = localStorage.getItem("gallery-site-boot");
          if (raw) {
            const parsed = JSON.parse(raw);
            const cachedTitle = String(parsed && parsed.title ? parsed.title : "").trim();
            if (cachedTitle) {
              title = cachedTitle;
            }
          }
        } catch (_) {
          // ignore
        }

        document.write("<title>" + escapeHtml(title) + "</title>");
      })();
    </script>
    <noscript><title>Gallery-Portfolio</title></noscript>
    <script>
      (function () {
        try {
          const params = new URLSearchParams(window.location.search);
          const raw = String(params.get("fullscreen") || "").trim().toLowerCase();
          const waterfallValues = ["0", "false", "no", "off"];
          const isWaterfall = waterfallValues.includes(raw);
          document.documentElement.classList.add(isWaterfall ? "boot-waterfall" : "boot-fullscreen");
        } catch (_) {
          document.documentElement.classList.add("boot-fullscreen");
        }
      })();
    </script>
    <style>
      html.boot-fullscreen body {
        margin: 0;
        background: #000;
      }
      html.boot-fullscreen body.app-booting > header,
      html.boot-fullscreen body.app-booting > .gallery,
      html.boot-fullscreen body.app-booting > .tag-filter,
      html.boot-fullscreen body.app-booting > .tag-filter-vertical,
      html.boot-fullscreen body.app-booting > footer,
      html.boot-fullscreen body.app-booting > #myModal {
        display: none !important;
      }
    </style>
    <link rel="stylesheet" href="public/styles.css?v=20260301-8" />
    <link rel="stylesheet" href="public/gallery.css?v=20260301-8" />
    <link rel="icon" href="public/assets/favicon.svg" type="image/svg+xml" />
  </head>
  <body class="app-booting">
    <header>
      <h1>
        <a
          href="/"
          class="site-title-link"
          aria-label="Gallery-Portfolio"
          title="Gallery-Portfolio"
        >
          <img
            id="site-logo"
            class="site-logo site-logo-hidden"
            alt=""
            width="24"
            height="24"
            decoding="async"
            loading="lazy"
          />
          <span id="site-title-text">Gallery-Portfolio</span>
        </a>
      </h1>
      <div class="header-buttons">
        <button id="shuffle-toggle" class="header-action-btn" aria-label="随机排序开关">
          <svg viewBox="0 0 24 24"><path d="M16 3h5v5M4 20L21 3M21 16v5h-5M15 15l6 6M4 4l5 5"/></svg>
        </button>
        <button id="random-image-btn" class="header-action-btn" aria-label="查看随机图">
          <svg viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><circle cx="15.5" cy="8.5" r="1.5"/><circle cx="8.5" cy="15.5" r="1.5"/><circle cx="15.5" cy="15.5" r="1.5"/><circle cx="12" cy="12" r="1.5"/></svg>
        </button>
        <button id="fullscreen-toggle" class="header-action-btn" aria-label="全屏模式开关">
          <svg viewBox="0 0 24 24"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/></svg>
        </button>
        <a id="admin-link" class="admin-link" href="/admin/" aria-label="进入管理后台">Admin</a>
        <a
          id="github-link"
          class="header-action-btn"
          href="https://github.com/linyuxuanlin/Gallery-Portfolio"
          target="_blank"
          aria-label="访问 GitHub 仓库"
          style="text-decoration:none;"
        >
          <svg viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0 0 24 12c0-6.63-5.37-12-12-12z"/></svg>
        </a>
        <button id="theme-toggle" class="header-action-btn" aria-label="切换深色/浅色主题">
          <img
            src="public/assets/brightness_4.svg"
            alt="Toggle Theme"
            id="theme-icon"
          />
        </button>
      </div>
    </header>
    <div id="loading"></div>
    <div id="single-image-stage" class="single-image-stage">
      <img id="single-image" alt="Gallery Image" />
    </div>
    <button
      id="fullscreen-upload-btn"
      class="fullscreen-upload-btn upload-hidden"
      type="button"
      aria-label="上传图片"
      title="上传图片"
    >
      <span class="upload-btn-icon" aria-hidden="true">+</span>
    </button>

    <div id="upload-modal" class="upload-modal upload-hidden" role="dialog" aria-modal="true" aria-labelledby="upload-modal-title">
      <div class="upload-modal-card">
        <h2 id="upload-modal-title">上传图片</h2>
        <p id="upload-modal-description" class="upload-modal-description">
          点击下方区域选择图片后上传。
        </p>
        <p class="upload-target-dir">目标目录：<code id="upload-folder-label">/</code></p>

        <form id="upload-form" novalidate>
          <div id="upload-dropzone" class="upload-dropzone" role="button" tabindex="0" aria-label="点击选择图片">
            <svg class="upload-dropzone-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="17 8 12 3 7 8"/>
              <line x1="12" y1="3" x2="12" y2="15"/>
            </svg>
            <span class="upload-dropzone-text">点击选择图片</span>
            <span id="upload-file-name" class="upload-dropzone-filename"></span>
            <input id="upload-file-input" name="file" type="file" accept="image/*" required />
          </div>

          <div class="upload-modal-actions">
            <button id="upload-cancel-btn" class="upload-btn-secondary" type="button">取消</button>
            <button id="upload-submit-btn" class="upload-btn-primary" type="submit">开始上传</button>
          </div>

          <p id="upload-feedback" class="upload-feedback" role="status" aria-live="polite"></p>
        </form>
      </div>
    </div>
    <div class="gallery" id="gallery"></div>

    <!-- Modal for image display -->
    <div id="myModal" class="modal">
      <span class="close">&times;</span>
      <img class="modal-content" id="img01" />
      <div id="exif-info"></div>
      <button id="load-original-btn" class="load-original-btn">加载原图</button>
    </div>

    <!-- 加载JavaScript模块 -->
    <script src="public/data-loader.js?v=20260301-8"></script>
    <script src="public/tag-filter.js?v=20260301-8"></script>
    <script src="public/image-loader.js?v=20260301-8"></script>
    <script src="public/auto-scroll.js?v=20260301-8"></script>
    <script src="public/layout.js?v=20260301-8"></script>
    <script src="public/gallery.js?v=20260301-8"></script>
  </body>
</html> 
